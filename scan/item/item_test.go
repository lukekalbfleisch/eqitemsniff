package analyzer

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/xackery/eqitemsniff/analyzer"
)

func TestItem(t *testing.T) {
	assert := assert.New(t)

	packet := &analyzer.EQPacket{}
	packets := []string{
		"cee34467000000574e654d303034303030307a775730300001000000001c000a00ffff00000000000000000100000000000000af6400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000ffffffff00000000004c6f6e672053776f7264004c6f6e672053776f72640049543100008a1300004b0000000101000200600000e02e00004e020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009d010000ffff0000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001d00000006000000000000ff000000000000000000000000000000000000000000000000000000803f0000000000000000000000000000000000ffffffff000000000400000001001400000001000000000001000000000001000000000001000000000001000000000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000c00000000000000ffffffff0000000000000100000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000",         //item.0
		"86000003d4e34467000000574e654d303034303030302b775730300001000000001c000b00ffff00000000000000000100000000000000b06400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000ffffffff0000000000526f756e6420536869656c6400526f756e6420536869656c6400495432303300002a230000320000000101000200400000dc0500001e02000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000bf4300007ff30000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff000000000800000000000000000000000000000000000000000000803f0000000000000000000000000000000000ffffffff00000000070000000100140000000100000000000100000000000100000000000100000000000100000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000200000000000000ffffffff0000000000000100000000000000000000000000000000000000000000000000ffffffff000000000000000000", //item.1
		"ffffff0000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff0000000000456e74616e676c6564204765617220536574004973206974206d61676963206f7220736f6d657468696e6720656c7365207468617420686f6c6473207468656d20746f676574686572004954363300007573020010000000010000010100000000000000300900000000473f333c3d01322c333b332d255219000012190000121900000d010000070000000700000000000000ffff0000ffff0000000000000000000000000000ffffffff000000000000000000000000000000000000000001000000006e00000000000000000000000000000000000000000000000000000000000000ff1a0000003400000000000000000000000000000000000000000000803f0000000000000000b23c00004348524d54424c436c61737341726d6f720000000000ffffffff0000000003000000010005000000010007000000010016000000010000000000010000000000010000000000000000000000000046000000000000000000000000000000000000000001530000002c000000000000000153000000000000ffffffff00000000000001000000000000000000000000000000000000000000000000008f9b0000000500000000ffffff",         // item.2
		"0018001600ffff000000000000000001000000000000001e6300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff0000000000426c61636b20506f7764657220506f756368004120706f756368206f6620766f6c6174696c6520626c61636b20706f7764657220666f72206372616674696e6700495436340000ed3c0100030000000101000000000000010000001e08000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff0000ffff0000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff000000000b000000000000000000000000000000000000000000401c460000000000000000000000000000000000ffffffff00000000000000000100000000000100000000000100000000000100000000000100000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000e803000000000000000000000000000000000000000000000000ffffff",         // item.3
		"0000000000000000000000000000000000ffffffff000000000080841e00000000000000000000fdfffffffdfffffffdffffff040000000400000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000010000000000000000000000000000000000050000003675613230393030303032326d3030300001000000001e000500ffff00000000000000000100000000000000af6300000000000000000000000000000000000044fd1d00000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff0000000000436c6966662053746f6e650053746f6e652066726f6d20746865206865617274206f66206120436c69666620476f6c656d00495436330000cd4f020005000000010000000000200000000000541900000000000000000000f10f141400f6f6e803000051ffffff51ffffff46000000050000000000000000000000ffff0000ffff0000000000000000000000000000ffffffff000000000000000000000000000000000000000001000000006d00000000000000",         // item.4
		"ffff000000000000000000000000000000000000000000000000000000ffffffff000000000080841e00000000000000000000fdfffffffdfffffffdffffff040000000400000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000b000000656947313039303030303058364734300010000000001e000b00ffff00000000000000000100000000000000b56300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff0000000000426565722d4261747465726564204d696e6f74617572204d65617420536f757000426565722d4261747465726564204d696e6f74617572204d65617420536f757000495436330000719000000700000001010002000000007c030000f903000000001404040f04000a0a08080303031f0000001f0000002700000000000000000000000000000000000000ffff0000ffff0000000000000000000000000000ffffffff0000000000",         // item.5
		"e600000000ffffffffffffffff000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000c00000036756132303930303030324c763030300001000000001e000c00ffff00000000000000000100000000000000b66300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff000000000041726373746f6e65205370697269742053617070686972650041726373746f6e6520537069726974205361707068697265004954363300009f5a0100010000000101000100000000f8240100f002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff0000ffff0000000000000000000000000000ffffffff0000000000000000000000000000", //item.6
		"00ffffffffffffffff000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000f00000036756132303930303030314b435730300001000000001e000f00ffff00000000000000000100000000000000b86300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff000000000053757270726973696e6720537570657263686172676564205368617264004e6f742073757265207768617420746869732069732c20627574206974207365656d732072656c61746976656c792075736566756c00495436330000864e0200000000000100000000600000000000004a04000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff0000ffff",     //item.7
		"02000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000e0000004c7a435930393030303032714f5738300001000000001d000e00ffff000000000000000001000000000000009d63000000000000c18cb75d000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff00000000014164616d616e7420547269756d7068616e7420436c6f75642042696e64696e67205772697374204d7568626973004164616d616e7420547269756d7068616e7420436c6f75642042696e64696e67205772697374204d756862697300495436330000ed7302000a00000001010000000000000000000054150000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000000000001000000006e00000000000000000000000000000000000000000000000000000000000000ff1a00000043000000000000", //item.8
		"0000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000036756132303930303030304b305730300001000000011200ffffffff00000000000000000100000000000000766500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff00000000014865726f6963205361746368656c206f662074686520416476656e7475726572004865726f6963205361746368656c206f662074686520416476656e747572657200495436330000a56e010008000000010000020000000000000000a218000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff0000ffff0000000000000000000000000000ffffffff000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000ff000000004300000000000000000000000000000000000000000000803f0000000000000000000000000000000000ffffffff00000000000000000100000000000100000000000100000000000100000000000100000000000100000000000000",         //item.9
		"00000000000000000000000000000000000000000000000000ffffffffffffffff000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000ffffffff0000ffffffff000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000036756132303930303030326b314730300001000000001800ffffffff00000000000000000100000000000000026300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000001ffffffff000000000153697a6561626c65205361746368656c004120646973656e6368616e746564207061636b20746861742063616e20686f6c64203430206974656d7300495436340000418d01000a000000010000030000000000000000310e000000000000000000000000000000000000000000000000000000000000000000000000000000000000",     //item.10
		"a30000ffffffff0000000000000000803f0000000000000000000000000000000000000000000000000000ffffffff00000000000000000000000000000000010000000000000000000000000000000000010000004c7a43593039303030303079476d3830000f0000000117000100ffff00000000000000000100000000000000c86500000000000000000000000000000000000000000000000000000116000000436f6e666c616772616e7420526573696c69656e63657d5202000000000000000000000000000000000000ffffffff000000000000000001ffffffff00000000005772617070656420436f6e666c616772616e7420526573696c69656e636500004954363300002e54020000000000010100000100000000000000a9070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff000000000000000000000000000000000000000001000000006a0000006e000000000000000000000000000000000000000000000000000000ff190000000b00000000000000000000000000000000000000000000803f0000000000000000000000000000000000ffffffff000000000000000001000000000001000000000001000000000001000000000001000000000001000000", //item.11
	}
	var err error
	for _, p := range packets {
		packet.Data, err = hex.DecodeString(p)
		if !assert.NoError(err) {
			t.Fatal(err)
		}
		item := Scan(packet)
		t.Log(item)
		t.Log(item.Name, item.Size, item.Slots)
	}
	t.Fatal("done")
}
